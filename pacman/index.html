<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Pac-Man+</title>
   <link rel="stylesheet" href="../arcade.css">
  <style>
    body{background:#000;color:#fff;text-align:center;font-family:Arial;margin:0;padding:10px}
    canvas{background:#111;display:block;margin:10px auto}
    .info{margin:6px 0}
  </style>
</head>
<body>
  <h1>Pac-Man+</h1>
  <div class="info">Lives: <span id="lives">3</span> · Score: <span id="score">0</span></div>
  <canvas id="game" width="448" height="256"></canvas>
  <div style="text-align:center;margin-top:10px">
    <a href="../index.html" class="back-btn">⟵ Back to Arcade</a>
  </div>
  <script>
    const tile=16, rows=16, cols=28;
    const canvas=document.getElementById('game'), ctx=canvas.getContext('2d');
    let lives=3, score=0;
    const maze=[
"1111111111111111111111111111",
"1000000000000110000000000001",
"1011111111100110111111111101",
"1011111111100110111111111101",
"1000000000000000000000000001",
"1011110111111111111011111101",
"1000000100000100000100000001",
"1111110110110110110110111111",
"1000000000110000001100000001",
"1011110111111111111110111101",
"1000000100000100000100000001",
"1111110110110110110110111111",
"1000000000000000000000000001",
"1011111111110111111111111101",
"1000000000000000000000000001",
"1111111111111111111111111111"
].map(r=>r.split('').map(n=>+n));
    let pac={x:14,y:13,dx:0,dy:0};
    let pellets=new Set();
    for(let y=0;y<rows;y++){for(let x=0;x<cols;x++){if(maze[y][x]===0)pellets.add(y+','+x)}}
    const ghosts=[
      {x:13,y:7,color:'red',dx:1,dy:0},
      {x:14,y:7,color:'pink',dx:-1,dy:0}
    ];
    function drawMaze(){for(let y=0;y<rows;y++)for(let x=0;x<cols;x++){if(maze[y][x]===1){ctx.fillStyle='blue';ctx.fillRect(x*tile,y*tile,tile,tile);}
      else if(pellets.has(y+','+x)){ctx.fillStyle='white';ctx.fillRect(x*tile+7,y*tile+7,2,2);}}}
    function drawPac(){ctx.beginPath();ctx.arc(pac.x*tile+8,pac.y*tile+8,7,0.25*Math.PI,1.75*Math.PI);ctx.lineTo(pac.x*tile+8,pac.y*tile+8);ctx.fillStyle='yellow';ctx.fill();}
    function drawGhost(g){ctx.fillStyle=g.color;ctx.fillRect(g.x*tile+2,g.y*tile+2,12,12);}
    function canMove(x,y){return maze[y] && maze[y][x]===0;}
    function step(){const nx=pac.x+pac.dx, ny=pac.y+pac.dy; if(canMove(nx,ny)){pac.x=nx;pac.y=ny;const key=pac.y+','+pac.x;if(pellets.delete(key)){score+=10;document.getElementById('score').textContent=score; if(pellets.size===0){alert('You win! Score '+score); reset();}}}
      ghosts.forEach(g=>{let choices=[{dx:Math.sign(pac.x-g.x),dy:0},{dx:0,dy:Math.sign(pac.y-g.y)}]; for(const c of choices){const gx=g.x+c.dx, gy=g.y+c.dy; if(canMove(gx,gy)){g.x=gx;g.y=gy;return;}}});
      for(const g of ghosts){if(g.x===pac.x && g.y===pac.y){lives--; document.getElementById('lives').textContent=lives; if(lives<=0){alert('Game Over! Score '+score); reset();} else {pac={x:14,y:13,dx:0,dy:0}; return;}}}
    }
    function draw(){ctx.clearRect(0,0,canvas.width,canvas.height); drawMaze(); drawPac(); ghosts.forEach(drawGhost);}
    function loop(){step(); draw(); requestAnimationFrame(loop);}
    document.addEventListener('keydown',e=>{const k=e.key; let d={x:0,y:0}; if(k==='ArrowUp')d={x:0,y:-1}; else if(k==='ArrowDown')d={x:0,y:1}; else if(k==='ArrowLeft')d={x:-1,y:0}; else if(k==='ArrowRight')d={x:1,y:0}; const nx=pac.x+d.x, ny=pac.y+d.y; if(canMove(nx,ny)){pac.dx=d.x; pac.dy=d.y;}});
    function reset(){lives=3;score=0;document.getElementById('score').textContent=0;document.getElementById('lives').textContent=3; pellets.clear(); for(let y=0;y<rows;y++)for(let x=0;x<cols;x++)if(maze[y][x]===0)pellets.add(y+','+x); pac={x:14,y:13,dx:0,dy:0}; ghosts[0].x=13;ghosts[0].y=7;ghosts[1].x=14;ghosts[1].y=7;}
    reset(); loop();
  </script>
</body>
</html>
