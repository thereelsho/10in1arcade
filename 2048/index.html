<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"><title>2048+</title>
<style>
  body{background:#000;color:#fff;text-align:center;font-family:Arial;margin:0;padding:10px}
  #game{width:440px;height:440px;margin:10px auto;display:grid;grid-template:repeat(4,1fr)/repeat(4,1fr);gap:8px;background:#222;padding:8px;border-radius:8px;border:2px solid #555}
  .cell{background:#333;display:flex;align-items:center;justify-content:center;font-size:2em;font-weight:bold;border-radius:6px;min-height:0}
  .hud{margin:6px 0}
  a.btn{color:#ff2d75;text-decoration:none}
</style>
</head>
<body>
<h1>2048+</h1>
<div class="hud">Score: <span id="score">0</span> · High: <span id="high">0</span></div>
<div id="game"></div>
<div style="margin-top:10px"><a class="btn" href="../index.html">⟵ Back to Arcade</a></div>
<script>
const N=4; let board=[], score=0;
const colors={2:'#eee4da',4:'#ede0c8',8:'#f2b179',16:'#f59563',32:'#f67c5f',64:'#f65e3b',128:'#edcf72',256:'#edcc61',512:'#edc850',1024:'#edc53f',2048:'#edc22e'};
function init(){board=Array(N).fill().map(()=>Array(N).fill(0)); score=0; add(); add(); draw(); update();}
function add(){let e=[]; for(let r=0;r<N;r++)for(let c=0;c<N;c++) if(board[r][c]===0)e.push([r,c]); if(e.length){const [r,c]=e[(Math.random()*e.length)|0]; board[r][c]=Math.random()<0.9?2:4;}}
function slide(row){row=row.filter(v=>v); for(let i=0;i<row.length-1;i++){ if(row[i]===row[i+1]){ row[i]*=2; score+=row[i]; row[i+1]=0; }} row=row.filter(v=>v); while(row.length<N) row.push(0); return row;}
function rotate(m){return m[0].map((_,i)=>m.map(r=>r[i]).reverse());}
function move(dir){
  let moved=false;
  if(dir==='left'){ for(let r=0;r<N;r++){const nr=slide(board[r]); moved|=nr.toString()!=board[r].toString(); board[r]=nr;}}
  else if(dir==='right'){ for(let r=0;r<N;r++){board[r].reverse(); board[r]=slide(board[r]).reverse(); moved=true;}}
  else{ // up/down
    for(let k=0;k<(dir==='up'?1:3);k++) board=rotate(board);
    for(let r=0;r<N;r++) board[r]=slide(board[r]);
    for(let k=0;k<(dir==='up'?3:1);k++) board=rotate(board);
    moved=true;
  }
  if(moved){ add(); draw(); update(); if(over()){const hi=Math.max(+localStorage.game2048||0,score); localStorage.game2048=hi; alert('Game over! Score: '+score+' · High: '+hi); init();}}
}
function over(){
  for(let r=0;r<N;r++)for(let c=0;c<N;c++) if(board[r][c]===0) return false;
  for(let r=0;r<N;r++)for(let c=0;c<N-1;c++) if(board[r][c]===board[r][c+1]) return false;
  for(let r=0;r<N-1;r++)for(let c=0;c<N;c++) if(board[r][c]===board[r+1][c]) return false;
  return true;
}
function draw(){
  const g=document.getElementById('game'); g.innerHTML='';
  for(let r=0;r<N;r++) for(let c=0;c<N;c++){
    const d=document.createElement('div'); d.className='cell'; const v=board[r][c]; d.textContent=v||''; d.style.background= v? (colors[v]||'#3c3c3c') : '#333'; d.style.color= v<=4?'#776e65':'#fff';
    g.appendChild(d);
  }
}
function update(){ document.getElementById('score').textContent=score; document.getElementById('high').textContent=localStorage.game2048||0; }
document.addEventListener('keydown',e=>{
  if(e.key==='ArrowLeft') move('left');
  else if(e.key==='ArrowRight') move('right');
  else if(e.key==='ArrowUp') move('up');
  else if(e.key==='ArrowDown') move('down');
});
init();
</script>
</body>
</html>
